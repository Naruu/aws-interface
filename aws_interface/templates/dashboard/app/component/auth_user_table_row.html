{% load timetags %}

{% for user in users %}
    <tr>
        <th scope="row">
            {{ user.id }}
        </th>
        <td>
            {{ user.creation_date|to_date }}
        </td>
        <td name="col-user-email">
            {{ user.email }}
        </td>
        <td>
            {% for group in user.groups %}
                <a onclick="detach_user_group('{{ user.id }}', '{{group}}')" class="btn badge badge-primary">{{ group }} <i class="fa fa-trash"></i></a>
            {% endfor %}
            <a data-toggle="modal" data-target="#modal-attach-user-group-{{ user.id }}" class="btn badge badge-info">+</a>

            <div class="modal fade" id="modal-attach-user-group-{{ user.id }}" tabindex="-1" role="dialog" aria-labelledby="modal-attach-user-group-{{ user.id }}" aria-hidden="true">
                <div class="modal-dialog modal- modal-dialog-centered modal-" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="modal-title-default">그룹 추가</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">×</span>
                            </button>
                        </div>
                        <form method="post">{% csrf_token %}
                            <input name="cmd" value="attach_user_group" hidden>
                            <input name="user_id" value="{{ user.id }}" hidden>
                            <div class="modal-body">
                                <div class="pl-lg-12">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group">
                                                <label class="form-control-label" for="input-username">그룹 이름</label>
                                                <select id="group-name" name="group_name" class="form-control form-control-alternative">
                                                    {% for group in user_groups %}
                                                        <option value="{{ group.name }}">{{ group.name }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p>
                                    확인 버튼을 클릭하여 회원에게 그룹을 부여합니다.
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-link  ml-auto" data-dismiss="modal">취소</button>
                                <button id="attach-user-group-{{ user.id }}" type="submit" class="btn btn-primary">확인</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </td>
        <td>
            {% for key, value in user.items %}
                {% if key not in visible_user_fields and key not in none_extra_fields %}
                    <h5> {{ key }} : {{ value }} </h5>
                {% endif %}
            {% endfor %}

        </td>
        <td>
            {{ user.login_method }}
        </td>
        <td>
            <div class="custom-control custom-radio mt--4">
                <input class="custom-control-input" type="radio" name="checkbox-user" id="{{ user.id }}">
                <label class="custom-control-label" for="{{ user.id }}"></label>
            </div>
        </td>
    </tr>
{% endfor %}